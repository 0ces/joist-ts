"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[827],{5318:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7378);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=r,f=p["".concat(c,".").concat(m)]||p[m]||u[m]||i;return n?a.createElement(f,o(o({ref:t},d),{},{components:n})):a.createElement(f,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5165:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return d},default:function(){return p}});var a=n(2685),r=n(1244),i=(n(7378),n(5318)),o=["components"],l={title:"Create/Update/Delete",sidebar_position:2},c=void 0,s={unversionedId:"querying/create-update-delete",id:"querying/create-update-delete",title:"Create/Update/Delete",description:"All work is made off of the Joist entity manager. When .flush() is called on the entity manager, Joist will perform all the hooks and validation checks before writing to the database. Flush can be called multiple times as work is done an entities.",source:"@site/docs/querying/create-update-delete.md",sourceDirName:"querying",slug:"/querying/create-update-delete",permalink:"/docs/querying/create-update-delete",editUrl:"https://github.com/stephen/joist-ts/edit/main/docs/docs/querying/create-update-delete.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Create/Update/Delete",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Unit of Work",permalink:"/docs/querying/unit-of-work"},next:{title:"Changed Fields",permalink:"/docs/querying/changed-fields"}},d=[{value:"<code>#create</code>",id:"create",children:[],level:3},{value:"<code>#createOrUpdatePartial</code>",id:"createorupdatepartial",children:[],level:3},{value:"<code>#setPartial</code>",id:"setpartial",children:[],level:3},{value:"Updating a field",id:"updating-a-field",children:[],level:3},{value:"<code>#delete</code>",id:"delete",children:[],level:3}],u={toc:d};function p(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"All work is made off of the Joist entity manager. When ",(0,i.kt)("inlineCode",{parentName:"p"},".flush()")," is called on the entity manager, Joist will perform all the hooks and validation checks before writing to the database. Flush can be called multiple times as work is done an entities."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst author = new Author(em, { firstName: "a1" });\nawait em.flush();\nauthor.firstName = "a2";\nawait em.flush();\n')),(0,i.kt)("h3",{id:"create"},(0,i.kt)("inlineCode",{parentName:"h3"},"#create")),(0,i.kt)("p",null,"Load an instance of a given entity and id"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const em = newEntityManager();\nconst a = await em.create(Author, { email: 'foo@bar.com' });\n")),(0,i.kt)("p",null,"Optionally, another way to create an entity is to do:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst a = new Author(em, { firstName: "a1", address: { street: "123 Main" } });\n')),(0,i.kt)("h3",{id:"createorupdatepartial"},(0,i.kt)("inlineCode",{parentName:"h3"},"#createOrUpdatePartial")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst a1 = await em.createOrUpdatePartial(Author, { firstName: "a1" });\n')),(0,i.kt)("h3",{id:"setpartial"},(0,i.kt)("inlineCode",{parentName:"h3"},"#setPartial")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst a1 = em.create(Author, { firstName: "a1" });\na1.setPartial({ firstName: \'a:2 });\n')),(0,i.kt)("h3",{id:"updating-a-field"},"Updating a field"),(0,i.kt)("p",null,"Another option to updating is setting the field directly."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst author = new Author(em, { firstName: "a1" });\nawait em.flush();\nauthor.firstName = "a2";\nawait em.flush();\n')),(0,i.kt)("h3",{id:"delete"},(0,i.kt)("inlineCode",{parentName:"h3"},"#delete")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const em = newEntityManager();\nconst a1 = await em.load(Author, "1");\nem.delete(a1);\n')))}p.isMDXComponent=!0}}]);